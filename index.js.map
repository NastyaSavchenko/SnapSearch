{"version":3,"file":"index.js","sources":["../src/js/config.js","../src/js/pixabay-api.js","../src/js/refs.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export const BASE_URL = 'https://pixabay.com/api/';\nexport const KEY = '32589447-ffbdd7a8f0a573b29764024b7';\nexport const PER_PAGE = 15;\n","import axios from 'axios';\nimport { BASE_URL, KEY, PER_PAGE } from './config';\n\nexport async function fetchImg(params) {\n  const options = new URLSearchParams({\n    ...params,\n    key: KEY,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: PER_PAGE,\n  });\n\n  const url = `${BASE_URL}?${options}`;\n\n  const {\n    data: { hits, totalHits },\n    status,\n  } = await axios.get(url);\n\n  if (status !== 200) {\n    throw new Error('An error occurred. Please try again later!');\n  }\n\n  return { hits, totalHits };\n}\n","export const refs = {\n  form: document.querySelector('.search-container'),\n  gallery: document.querySelector('.gallery-list'),\n  loader: document.querySelector('.loader'),\n  loadbtnEl: document.querySelector('.load-btn'),\n};\n","import { refs } from './refs';\n\nconst { gallery } = refs;\n\nfunction createMarkupLi(img) {\n  const {\n    tags,\n    comments,\n    downloads,\n    largeImageURL,\n    likes,\n    views,\n    webformatURL,\n  } = img;\n\n  return `<li class=\"gallery-item\">\n            <div class=\"img-container\">\n             <a href=\"${largeImageURL}\">\n              <img src=\"${webformatURL}\" alt=\"${tags}\" />\n              </a>\n            </div>\n            <ul class=\"info-list\">\n              <li class=\"info-item\">\n                <p class=\"info-name\">Likes</p>\n                <p class=\"info-value\">${likes}</p>\n              </li>\n              <li>\n                <p class=\"info-name\">Views</p>\n                <p class=\"info-value\">${views}</p>\n              </li>\n              <li>\n                <p class=\"info-name\">Comments</p>\n                <p class=\"info-value\">${comments}</p>\n              </li>\n              <li>\n                <p class=\"info-name\">Downloads</p>\n                <p class=\"info-value\">${downloads}</p>\n              </li>\n            </ul>\n          </li>`;\n}\n\nexport const renderImg = data => {\n  const imgMarkup = data.map(createMarkupLi).join('');\n  gallery.insertAdjacentHTML('beforeend', imgMarkup);\n};\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchImg } from './js/pixabay-api';\nimport { renderImg } from './js/render-functions';\nimport { refs } from './js/refs';\nimport { PER_PAGE } from './js/config';\n\nconst lightbox = new SimpleLightbox('.gallery-list a');\n\nlet page = 1;\nlet q = null;\nlet pages = 0;\n\nasync function handleFormSubmit(event) {\n  event.preventDefault();\n  const form = event.currentTarget;\n  const { query } = form.elements;\n\n  q = query.value.trim();\n  page = 1;\n\n  refs.gallery.innerHTML = '';\n  refs.loader.classList.remove('js-is-hidden');\n  refs.loadbtnEl.classList.add('js-is-hidden');\n\n  if (!q) {\n    iziToast.error({\n      position: 'topRight',\n      iconColor: '#FAFAFB',\n      message: 'Ð¡an not be empty or contain only spaces!',\n      backgroundColor: '#EF4040',\n    });\n    refs.loader.classList.add('js-is-hidden');\n    return;\n  }\n\n  refs.loader.classList.remove('js-is-hidden');\n\n  try {\n    const params = { q, page };\n    const { hits, totalHits } = await fetchImg(params);\n\n    pages = Math.ceil(totalHits / PER_PAGE);\n\n    refs.loader.classList.add('js-is-hidden');\n\n    if (pages <= 1) {\n      refs.loadbtnEl.classList.add('js-is-hidden');\n    } else {\n      refs.loadbtnEl.classList.remove('js-is-hidden');\n    }\n\n    if (hits.length === 0) {\n      iziToast.error({\n        position: 'topRight',\n        iconColor: '#FAFAFB',\n        message: `Sorry, there are no images matching <br/>your search query. Please try again!`,\n        backgroundColor: '#EF4040',\n      });\n\n      refs.loadbtnEl.classList.add('js-is-hidden');\n      refs.form.reset();\n    } else {\n      renderImg(hits);\n      lightbox.refresh();\n    }\n  } catch (error) {\n    iziToast.error({\n      position: 'topRight',\n      iconColor: '#FAFAFB',\n      message: `An error occurred. Please try again later!`,\n      backgroundColor: '#FF0000',\n    });\n\n    refs.loader.classList.add('js-is-hidden');\n    console.log(error);\n  } finally {\n    refs.loader.classList.add('js-is-hidden');\n  }\n\n  refs.form.reset();\n}\n\nasync function handleLoadMoreClick() {\n  page += 1;\n  refs.loader.classList.remove('js-is-hidden');\n\n  console.log('pages:', pages);\n  console.log('page:', page);\n\n  try {\n    const params = { q, page };\n    const { hits } = await fetchImg(params);\n    renderImg(hits);\n    lightbox.refresh();\n\n    if (page === pages) {\n      refs.loadbtnEl.classList.add('js-is-hidden');\n      iziToast.info({\n        position: 'topRight',\n        iconColor: '#FAFAFB',\n        message: `We're sorry, but you've reached the end of search results.`,\n        backgroundColor: '#FF0000',\n      });\n      return;\n    }\n\n    const lastImg = refs.gallery.lastElementChild;\n    const imgHeight = lastImg.getBoundingClientRect().height;\n    window.scrollBy({\n      top: imgHeight * 2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    iziToast.error({\n      position: 'topRight',\n      iconColor: '#FAFAFB',\n      message: `An error occurred. Please try again later!`,\n      backgroundColor: '#FF0000',\n    });\n    refs.loader.classList.add('js-is-hidden');\n    console.log(error);\n  } finally {\n    refs.loader.classList.add('js-is-hidden');\n  }\n}\n\nrefs.form.addEventListener('submit', handleFormSubmit);\nrefs.loadbtnEl.addEventListener('click', handleLoadMoreClick);\n"],"names":["BASE_URL","KEY","PER_PAGE","fetchImg","params","options","url","hits","totalHits","status","axios","refs","gallery","createMarkupLi","img","tags","comments","downloads","largeImageURL","likes","views","webformatURL","renderImg","data","imgMarkup","lightbox","SimpleLightbox","page","q","pages","handleFormSubmit","event","form","query","iziToast","error","handleLoadMoreClick","imgHeight"],"mappings":"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"}